<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deutsche Providerliste & Anbieterkennungen</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .net-d1 { background-color: #E20074; color: white; }
        .net-d2 { background-color: #E60000; color: white; }
        .net-o2 { background-color: #0019A5; color: white; }
        .net-1un1 { background-color: #13243F; color: white; border: 1px solid #0091FF; }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans">
    <header class="bg-white shadow-sm sticky top-0 z-10">
        <div class="max-w-4xl mx-auto px-4 py-4">
            <h1 class="text-2xl font-bold text-slate-900 mb-2">Providerliste Deutschland</h1>
            <p class="text-sm text-slate-500 mb-4">
                Suche nach Anbieter oder Kennung (z.B. "sim24", "VICT", "D1"). 
                <span id="last-updated" class="hidden ml-2 text-xs bg-gray-100 px-2 py-1 rounded"></span>
            </p>
            <div class="relative">
                <input type="text" id="searchInput" placeholder="Anbieter suchen..." 
                       class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none shadow-sm text-lg">
                <div class="absolute right-3 top-3 text-slate-400">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </div>
            </div>
        </div>
    </header>
    <main class="max-w-4xl mx-auto px-4 py-6">
        <div id="loading" class="flex justify-center py-10">
            <div class="loader"></div>
        </div>
        <div id="results-count" class="text-sm text-slate-400 mb-2 hidden"></div>
        <div class="bg-white rounded-xl shadow overflow-hidden hidden" id="table-container">
            <table class="min-w-full divide-y divide-slate-200">
                <thead class="bg-slate-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider w-1/2">Provider Name</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Kennung (Portierung)</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider">Netz</th>
                    </tr>
                </thead>
                <tbody id="provider-list" class="bg-white divide-y divide-slate-200">
                </tbody>
            </table>
        </div>
        <div id="no-results" class="hidden text-center py-10 text-slate-500">
            Keine Anbieter gefunden.
        </div>
    </main>
    <footer class="max-w-4xl mx-auto px-4 py-8 text-center text-xs text-slate-400">
        <p>Daten basieren auf Community-Recherchen. Alle Angaben ohne Gewähr.</p>
        <p class="mt-2"><a href="https://github.com/obdude/german-provider-list" class="underline hover:text-slate-600">Edit on GitHub</a></p>
    </footer>
    <script>
        let providers = [];

        function getNetBadge(net) {
            let cleanNet = net.replace('(', '').replace(')', '').trim();
            if(cleanNet === 'D1') return '<span class="px-2 py-1 text-xs font-bold rounded net-d1">Telekom (D1)</span>';
            if(cleanNet === 'D2') return '<span class="px-2 py-1 text-xs font-bold rounded net-d2">Vodafone (D2)</span>';
            if(cleanNet === 'O2') return '<span class="px-2 py-1 text-xs font-bold rounded net-o2">O2 / Telefónica</span>';
            if(cleanNet === '1&1') return '<span class="px-2 py-1 text-xs font-bold rounded net-1un1">1&1 5G</span>';
            return `<span class="px-2 py-1 text-xs font-bold rounded bg-gray-200 text-gray-700">${net}</span>`;
        }

        async function loadData() {
            try {
                const response = await fetch('providers.json');
                providers = await response.json();
                providers.sort((a, b) => a.name.localeCompare(b.name));
                renderTable(providers);
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('table-container').classList.remove('hidden');
            } catch (error) {
                console.error("Error loading providers:", error);
                document.getElementById('loading').innerHTML = "Fehler beim Laden der Daten.";
            }
        }

        function renderTable(data) {
            const tbody = document.getElementById('provider-list');
            const countDiv = document.getElementById('results-count');
            const noResults = document.getElementById('no-results');
            
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                document.getElementById('table-container').classList.add('hidden');
                noResults.classList.remove('hidden');
                countDiv.innerHTML = '';
                return;
            }

            document.getElementById('table-container').classList.remove('hidden');
            noResults.classList.add('hidden');
            countDiv.classList.remove('hidden');
            countDiv.textContent = `${data.length} Anbieter gefunden`;

            data.forEach(p => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900">${p.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500 font-mono bg-slate-50">${p.code}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-500">${getNetBadge(p.net)}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = providers.filter(p => 
                p.name.toLowerCase().includes(term) || 
                p.code.toLowerCase().includes(term) ||
                p.net.toLowerCase().includes(term)
            );
            renderTable(filtered);
        });

        loadData();
    </script>
</body>
</html>
